<dx:ThemedWindow x:Class="VisionAlgolismViewer.MainWindow"
        xmlns="http://schemas.microsoft.com/winfx/2006/xaml/presentation"
        xmlns:x="http://schemas.microsoft.com/winfx/2006/xaml"
        xmlns:dx="http://schemas.devexpress.com/winfx/2008/xaml/core"
        xmlns:dxlc= "http://schemas.devexpress.com/winfx/2008/xaml/layoutcontrol"
        xmlns:dxr="http://schemas.devexpress.com/winfx/2008/xaml/ribbon"
        xmlns:dxrt="http://schemas.devexpress.com/winfx/2008/xaml/ribbon/themekeys"
        xmlns:dxb="http://schemas.devexpress.com/winfx/2008/xaml/bars"
        xmlns:vm="clr-namespace:VisionAlgolismViewer.ViewModels"
        Title="Vision Algorithm Viewer - IrfanView Style"
        Height="800" Width="1400"
        WindowStartupLocation="CenterScreen">

    <dx:ThemedWindow.DataContext>
        <vm:MainViewModel/>
    </dx:ThemedWindow.DataContext>

    <Grid>
        <Grid.RowDefinitions>
            <RowDefinition Height="Auto"/>
            <RowDefinition Height="*"/>
            <RowDefinition Height="Auto"/>
        </Grid.RowDefinitions>

        <!-- Ribbon Control -->
        <dxr:RibbonControl Grid.Row="0" RibbonStyle="Office2019">

            <!-- File Page Category -->
            <dxr:RibbonDefaultPageCategory>

                <!-- Home Tab -->
                <dxr:RibbonPage Caption="Home">
                    <dxr:RibbonPageGroup Caption="File">
                        <dxb:BarButtonItem Content="Open"
                                          RibbonStyle="Large"
                                          Command="{Binding OpenImageCommand}"/>
                        <dxb:BarButtonItem Content="Save"
                                          RibbonStyle="Large"
                                          Command="{Binding SaveImageCommand}"/>
                        <dxb:BarButtonItem Content="Reset"
                                          RibbonStyle="Large"
                                          Command="{Binding ResetImageCommand}"/>
                    </dxr:RibbonPageGroup>

                    <dxr:RibbonPageGroup Caption="View">
                        <dxb:BarButtonItem Content="Fit to Window"
                                          RibbonStyle="Large"
                                          Command="{Binding FitToWindowCommand}"/>
                        <dxb:BarButtonItem Content="Actual Size"
                                          RibbonStyle="Large"
                                          Command="{Binding ActualSizeCommand}"/>
                        <dxb:BarButtonItem Content="Fill"
                                          RibbonStyle="Large"
                                          Command="{Binding FillCommand}"/>
                    </dxr:RibbonPageGroup>
                </dxr:RibbonPage>

                <!-- Image Effects Tab -->
                <dxr:RibbonPage Caption="Effects">
                    <dxr:RibbonPageGroup Caption="Basic Filters">
                        <dxb:BarButtonItem Content="Grayscale"
                                          Command="{Binding ApplyGrayscaleCommand}"/>
                        <dxb:BarButtonItem Content="Sepia"
                                          Command="{Binding ApplySepiaCommand}"/>
                        <dxb:BarButtonItem Content="Negative"
                                          Command="{Binding ApplyNegativeCommand}"/>
                    </dxr:RibbonPageGroup>

                    <dxr:RibbonPageGroup Caption="Blur Sharpen">
                        <dxb:BarButtonItem Content="Blur"
                                          Command="{Binding ApplyBlurCommand}"/>
                        <dxb:BarButtonItem Content="Sharpen"
                                          Command="{Binding ApplySharpenCommand}"/>
                        <dxb:BarButtonItem Content="Median"
                                          Command="{Binding ApplyMedianFilterCommand}"/>
                        <dxb:BarButtonItem Content="Box Blur"
                                          Command="{Binding ApplyBoxBlurCommand}"/>
                    </dxr:RibbonPageGroup>

                    <dxr:RibbonPageGroup Caption="Advanced Filters">
                        <dxb:BarButtonItem Content="Edge (Sobel)"
                                          Command="{Binding ApplyEdgeDetectionCommand}"/>
                        <dxb:BarButtonItem Content="Edge (Laplacian)"
                                          Command="{Binding ApplyEdgeDetectionLaplacianCommand}"/>
                        <dxb:BarButtonItem Content="Emboss"
                                          Command="{Binding ApplyEmbossCommand}"/>
                    </dxr:RibbonPageGroup>
                </dxr:RibbonPage>

            </dxr:RibbonDefaultPageCategory>
        </dxr:RibbonControl>

        <!-- Main Content -->
        <Grid Grid.Row="1">
            <Grid.ColumnDefinitions>
                <ColumnDefinition Width="*"/>
                <ColumnDefinition Width="350"/>
            </Grid.ColumnDefinitions>

            <!-- Image Viewer -->
            <Border x:Name="ImageBorder" Grid.Column="0" Background="#FF2D2D30" Margin="5">
                <Grid>
                    <Image x:Name="MainImage"
                           Source="{Binding CurrentImage}"
                           Stretch="{Binding ImageStretch}"
                           HorizontalAlignment="Center"
                           VerticalAlignment="Center"
                           RenderOptions.BitmapScalingMode="HighQuality"
                           MouseMove="MainImage_MouseMove"
                           MouseLeave="MainImage_MouseLeave"/>
                    <ScrollViewer x:Name="ImageScrollViewer"
                                 HorizontalScrollBarVisibility="Auto"
                                 VerticalScrollBarVisibility="Auto"
                                 Visibility="Collapsed">
                        <Image x:Name="ScrollImage"
                               Source="{Binding CurrentImage}"
                               Stretch="None"
                               RenderOptions.BitmapScalingMode="HighQuality"
                               MouseMove="ScrollImage_MouseMove"
                               MouseLeave="ScrollImage_MouseLeave"/>
                    </ScrollViewer>

                    <!-- Pixel Info Overlay -->
                    <Border x:Name="PixelInfoPanel"
                            HorizontalAlignment="Left"
                            VerticalAlignment="Top"
                            Margin="10"
                            Background="#DD000000"
                            BorderBrush="#FF555555"
                            BorderThickness="1"
                            CornerRadius="4"
                            Padding="10,5"
                            Visibility="Collapsed">
                        <StackPanel>
                            <TextBlock x:Name="PixelPositionText"
                                      Text="X: 0, Y: 0"
                                      Foreground="White"
                                      FontSize="11"
                                      FontFamily="Consolas"/>
                            <TextBlock x:Name="PixelRgbText"
                                      Text="RGB: (0, 0, 0)"
                                      Foreground="#FFFF6B6B"
                                      FontSize="11"
                                      FontFamily="Consolas"
                                      Margin="0,2,0,0"/>
                            <TextBlock x:Name="PixelHsvText"
                                      Text="HSV: (0Â°, 0%, 0%)"
                                      Foreground="#FF4ECDC4"
                                      FontSize="11"
                                      FontFamily="Consolas"
                                      Margin="0,2,0,0"/>
                        </StackPanel>
                    </Border>
                </Grid>
            </Border>

            <!-- Control Panel -->
            <Border Grid.Column="1" BorderThickness="1,0,0,0">
                <ScrollViewer VerticalScrollBarVisibility="Auto">
                    <StackPanel Margin="10">

                        <!-- Basic Adjustments -->
                        <dxlc:GroupBox Header="Basic Adjustments" Margin="0,5">
                            <StackPanel>
                                <TextBlock Text="Brightness" Margin="0,5,0,2"/>
                                <Grid>
                                    <Grid.ColumnDefinitions>
                                        <ColumnDefinition Width="*"/>
                                        <ColumnDefinition Width="50"/>
                                    </Grid.ColumnDefinitions>
                                    <Slider Grid.Column="0" Minimum="-100" Maximum="100"
                                            Value="{Binding Brightness, Mode=TwoWay}"
                                            TickFrequency="10" IsSnapToTickEnabled="True"/>
                                    <TextBlock Grid.Column="1" Text="{Binding Brightness, StringFormat='{}{0:F0}'}"
                                               VerticalAlignment="Center" HorizontalAlignment="Center"/>
                                </Grid>

                                <TextBlock Text="Contrast" Margin="0,10,0,2"/>
                                <Grid>
                                    <Grid.ColumnDefinitions>
                                        <ColumnDefinition Width="*"/>
                                        <ColumnDefinition Width="50"/>
                                    </Grid.ColumnDefinitions>
                                    <Slider Grid.Column="0" Minimum="-100" Maximum="100"
                                            Value="{Binding Contrast, Mode=TwoWay}"
                                            TickFrequency="10" IsSnapToTickEnabled="True"/>
                                    <TextBlock Grid.Column="1" Text="{Binding Contrast, StringFormat='{}{0:F0}'}"
                                               VerticalAlignment="Center" HorizontalAlignment="Center"/>
                                </Grid>

                                <TextBlock Text="Gamma" Margin="0,10,0,2"/>
                                <Grid>
                                    <Grid.ColumnDefinitions>
                                        <ColumnDefinition Width="*"/>
                                        <ColumnDefinition Width="50"/>
                                    </Grid.ColumnDefinitions>
                                    <Slider Grid.Column="0" Minimum="0.1" Maximum="3.0"
                                            Value="{Binding Gamma, Mode=TwoWay}"
                                            TickFrequency="0.1" IsSnapToTickEnabled="True"/>
                                    <TextBlock Grid.Column="1" Text="{Binding Gamma, StringFormat='{}{0:F1}'}"
                                               VerticalAlignment="Center" HorizontalAlignment="Center"/>
                                </Grid>
                            </StackPanel>
                        </dxlc:GroupBox>

                        <!-- Color Adjustments -->
                        <dxlc:GroupBox Header="Color Adjustments" Margin="0,5">
                            <StackPanel>
                                <TextBlock Text="Saturation" Margin="0,5,0,2"/>
                                <Grid>
                                    <Grid.ColumnDefinitions>
                                        <ColumnDefinition Width="*"/>
                                        <ColumnDefinition Width="50"/>
                                    </Grid.ColumnDefinitions>
                                    <Slider Grid.Column="0" Minimum="-100" Maximum="100"
                                            Value="{Binding Saturation, Mode=TwoWay}"
                                            TickFrequency="10" IsSnapToTickEnabled="True"/>
                                    <TextBlock Grid.Column="1" Text="{Binding Saturation, StringFormat='{}{0:F0}'}"
                                               VerticalAlignment="Center" HorizontalAlignment="Center"/>
                                </Grid>

                                <TextBlock Text="Hue" Margin="0,10,0,2"/>
                                <Grid>
                                    <Grid.ColumnDefinitions>
                                        <ColumnDefinition Width="*"/>
                                        <ColumnDefinition Width="50"/>
                                    </Grid.ColumnDefinitions>
                                    <Slider Grid.Column="0" Minimum="-180" Maximum="180"
                                            Value="{Binding Hue, Mode=TwoWay}"
                                            TickFrequency="15" IsSnapToTickEnabled="True"/>
                                    <TextBlock Grid.Column="1" Text="{Binding Hue, StringFormat='{}{0:F0}'}"
                                               VerticalAlignment="Center" HorizontalAlignment="Center"/>
                                </Grid>

                                <TextBlock Text="Red Channel" Margin="0,10,0,2"/>
                                <Grid>
                                    <Grid.ColumnDefinitions>
                                        <ColumnDefinition Width="*"/>
                                        <ColumnDefinition Width="50"/>
                                    </Grid.ColumnDefinitions>
                                    <Slider Grid.Column="0" Minimum="-100" Maximum="100"
                                            Value="{Binding RedAdjustment, Mode=TwoWay}"
                                            TickFrequency="10" IsSnapToTickEnabled="True"/>
                                    <TextBlock Grid.Column="1" Text="{Binding RedAdjustment, StringFormat='{}{0:F0}'}"
                                               VerticalAlignment="Center" HorizontalAlignment="Center" Foreground="Red"/>
                                </Grid>

                                <TextBlock Text="Green Channel" Margin="0,10,0,2"/>
                                <Grid>
                                    <Grid.ColumnDefinitions>
                                        <ColumnDefinition Width="*"/>
                                        <ColumnDefinition Width="50"/>
                                    </Grid.ColumnDefinitions>
                                    <Slider Grid.Column="0" Minimum="-100" Maximum="100"
                                            Value="{Binding GreenAdjustment, Mode=TwoWay}"
                                            TickFrequency="10" IsSnapToTickEnabled="True"/>
                                    <TextBlock Grid.Column="1" Text="{Binding GreenAdjustment, StringFormat='{}{0:F0}'}"
                                               VerticalAlignment="Center" HorizontalAlignment="Center" Foreground="Green"/>
                                </Grid>

                                <TextBlock Text="Blue Channel" Margin="0,10,0,2"/>
                                <Grid>
                                    <Grid.ColumnDefinitions>
                                        <ColumnDefinition Width="*"/>
                                        <ColumnDefinition Width="50"/>
                                    </Grid.ColumnDefinitions>
                                    <Slider Grid.Column="0" Minimum="-100" Maximum="100"
                                            Value="{Binding BlueAdjustment, Mode=TwoWay}"
                                            TickFrequency="10" IsSnapToTickEnabled="True"/>
                                    <TextBlock Grid.Column="1" Text="{Binding BlueAdjustment, StringFormat='{}{0:F0}'}"
                                               VerticalAlignment="Center" HorizontalAlignment="Center" Foreground="Blue"/>
                                </Grid>
                            </StackPanel>
                        </dxlc:GroupBox>

                        <!-- Filter Parameters -->
                        <dxlc:GroupBox Header="Filter Parameters" Margin="0,5">
                            <StackPanel>
                                <TextBlock Text="Blur Sigma" Margin="0,5,0,2"/>
                                <Grid>
                                    <Grid.ColumnDefinitions>
                                        <ColumnDefinition Width="*"/>
                                        <ColumnDefinition Width="50"/>
                                    </Grid.ColumnDefinitions>
                                    <Slider Grid.Column="0" Minimum="0.1" Maximum="50"
                                            Value="{Binding BlurSigma, Mode=TwoWay}"
                                            TickFrequency="0.5" IsSnapToTickEnabled="True"/>
                                    <TextBlock Grid.Column="1" Text="{Binding BlurSigma, StringFormat='{}{0:F1}'}"
                                               VerticalAlignment="Center" HorizontalAlignment="Center"/>
                                </Grid>

                                <TextBlock Text="Sharpen Amount" Margin="0,10,0,2"/>
                                <Grid>
                                    <Grid.ColumnDefinitions>
                                        <ColumnDefinition Width="*"/>
                                        <ColumnDefinition Width="50"/>
                                    </Grid.ColumnDefinitions>
                                    <Slider Grid.Column="0" Minimum="0" Maximum="5"
                                            Value="{Binding SharpenAmount, Mode=TwoWay}"
                                            TickFrequency="0.1" IsSnapToTickEnabled="True"/>
                                    <TextBlock Grid.Column="1" Text="{Binding SharpenAmount, StringFormat='{}{0:F1}'}"
                                               VerticalAlignment="Center" HorizontalAlignment="Center"/>
                                </Grid>
                            </StackPanel>
                        </dxlc:GroupBox>

                    </StackPanel>
                </ScrollViewer>
            </Border>
        </Grid>

        <!-- Status Bar -->
        <dxb:StatusBarControl Grid.Row="2">
            <dxb:BarStaticItem Content="{Binding StatusText}"/>
        </dxb:StatusBarControl>

    </Grid>
</dx:ThemedWindow>
