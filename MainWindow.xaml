<dx:ThemedWindow x:Class="VisionAlgolismViewer.MainWindow"
        xmlns="http://schemas.microsoft.com/winfx/2006/xaml/presentation"
        xmlns:x="http://schemas.microsoft.com/winfx/2006/xaml"
        xmlns:dx="http://schemas.devexpress.com/winfx/2008/xaml/core"
        xmlns:dxlc= "http://schemas.devexpress.com/winfx/2008/xaml/layoutcontrol"
        xmlns:dxr="http://schemas.devexpress.com/winfx/2008/xaml/ribbon"
        xmlns:dxrt="http://schemas.devexpress.com/winfx/2008/xaml/ribbon/themekeys"
        xmlns:dxb="http://schemas.devexpress.com/winfx/2008/xaml/bars"
        xmlns:vm="clr-namespace:VisionAlgolismViewer.ViewModels"
        xmlns:local="clr-namespace:VisionAlgolismViewer.Converters"
        Title="Image Helper Viewer"
        Height="800" Width="1400"
        WindowStartupLocation="CenterScreen">

    <dx:ThemedWindow.DataContext>
        <vm:MainViewModel/>
    </dx:ThemedWindow.DataContext>

    <Grid>
        <Grid.RowDefinitions>
            <RowDefinition Height="Auto"/>
            <RowDefinition Height="*"/>
            <RowDefinition Height="Auto"/>
        </Grid.RowDefinitions>

        <!-- Ribbon Control -->
        <dxr:RibbonControl Grid.Row="0" RibbonStyle="Office2019">

            <!-- File Page Category -->
            <dxr:RibbonDefaultPageCategory>

                <!-- Home Tab -->
                <dxr:RibbonPage Caption="Home">
                    <dxr:RibbonPageGroup Caption="File">
                        <dxb:BarButtonItem Content="Open"
                                          RibbonStyle="Large"
                                          Command="{Binding OpenImageCommand}"/>
                        <dxb:BarButtonItem Content="Save"
                                          RibbonStyle="Large"
                                          Command="{Binding SaveImageCommand}"/>
                        <dxb:BarButtonItem Content="Reset"
                                          RibbonStyle="Large"
                                          Command="{Binding ResetImageCommand}"/>
                    </dxr:RibbonPageGroup>

                    <dxr:RibbonPageGroup Caption="View">
                        <dxb:BarButtonItem Content="Fit to Window"
                                          RibbonStyle="Large"
                                          Command="{Binding FitToWindowCommand}"/>
                        <dxb:BarButtonItem Content="Actual Size"
                                          RibbonStyle="Large"
                                          Command="{Binding ActualSizeCommand}"/>
                        <dxb:BarButtonItem Content="Fill"
                                          RibbonStyle="Large"
                                          Command="{Binding FillCommand}"/>
                    </dxr:RibbonPageGroup>
                </dxr:RibbonPage>

                <!-- Image Effects Tab -->
                <dxr:RibbonPage Caption="Effects">
                    <dxr:RibbonPageGroup Caption="Basic Filters">
                        <dxb:BarButtonItem Content="Grayscale"
                                          Command="{Binding ApplyGrayscaleCommand}"/>
                        <dxb:BarButtonItem Content="Sepia"
                                          Command="{Binding ApplySepiaCommand}"/>
                        <dxb:BarButtonItem Content="Negative"
                                          Command="{Binding ApplyNegativeCommand}"/>
                    </dxr:RibbonPageGroup>

                    <dxr:RibbonPageGroup Caption="Blur Sharpen">
                        <dxb:BarButtonItem Content="Blur"
                                          Command="{Binding ApplyBlurCommand}"/>
                        <dxb:BarButtonItem Content="Sharpen"
                                          Command="{Binding ApplySharpenCommand}"/>
                        <dxb:BarButtonItem Content="Median"
                                          Command="{Binding ApplyMedianFilterCommand}"/>
                        <dxb:BarButtonItem Content="Box Blur"
                                          Command="{Binding ApplyBoxBlurCommand}"/>
                    </dxr:RibbonPageGroup>

                    <dxr:RibbonPageGroup Caption="Advanced Filters">
                        <dxb:BarButtonItem Content="Edge (Sobel)"
                                          Command="{Binding ApplyEdgeDetectionCommand}"/>
                        <dxb:BarButtonItem Content="Edge (Laplacian)"
                                          Command="{Binding ApplyEdgeDetectionLaplacianCommand}"/>
                        <dxb:BarButtonItem Content="Emboss"
                                          Command="{Binding ApplyEmbossCommand}"/>
                    </dxr:RibbonPageGroup>
                    <dxr:RibbonPageGroup Caption="EyeReduction">
                        <dxb:BarButtonItem Content="Red Reduction"
                      Command="{Binding ApplyRedEyeReductionCommand}"/>
                        <dxb:BarButtonItem Content="Blue Reduction"
                      Command="{Binding ApplyBlueEyeReductionCommand}"/>
                        <dxb:BarButtonItem Content="Green Reduction"
                      Command="{Binding ApplyGreenEyeReductionCommand}"/>
                    </dxr:RibbonPageGroup>
                    <dxr:RibbonPageGroup Caption="Remove Channels">
                        <dxb:BarButtonItem Content="Remove Red"
                                          Command="{Binding RemoveRedChannelCommand}"/>
                        <dxb:BarButtonItem Content="Remove Green"
                                          Command="{Binding RemoveGreenChannelCommand}"/>
                        <dxb:BarButtonItem Content="Remove Blue"
                                          Command="{Binding RemoveBlueChannelCommand}"/>
                        <dxb:BarButtonItem Content="Show All (RGB)"
                                          Command="{Binding ShowAllChannelsCommand}"/>
                    </dxr:RibbonPageGroup>
                </dxr:RibbonPage>

            </dxr:RibbonDefaultPageCategory>
        </dxr:RibbonControl>

        <!-- Main Content -->
        <Grid Grid.Row="1">
            <Grid.ColumnDefinitions>
                <ColumnDefinition Width="*"/>
                <ColumnDefinition Width="350"/>
            </Grid.ColumnDefinitions>

            <!-- Image Viewers Container -->
            <Grid Grid.Column="0">
                <Grid.RowDefinitions>
                    <RowDefinition Height="Auto"/>
                    <RowDefinition Height="*"/>
                    <RowDefinition Height="Auto"/>
                </Grid.RowDefinitions>

                <!-- History Navigation Bar -->
                <Border Grid.Row="0" Background="#FF252526" BorderBrush="#FF3E3E42" BorderThickness="0,0,0,1" Padding="10">
                    <Grid>
                        <Grid.ColumnDefinitions>
                            <ColumnDefinition Width="Auto"/>
                            <ColumnDefinition Width="Auto"/>
                            <ColumnDefinition Width="*"/>
                            <ColumnDefinition Width="Auto"/>
                            <ColumnDefinition Width="Auto"/>
                            <ColumnDefinition Width="Auto"/>
                        </Grid.ColumnDefinitions>

                        <!-- Back Button -->
                        <dx:SimpleButton Grid.Column="0" Content="◀ Back"
                                        Command="{Binding NavigateBackCommand}"
                                        Margin="0,0,5,0" Width="80"/>

                        <!-- Forward Button -->
                        <dx:SimpleButton Grid.Column="1" Content="Forward ▶"
                                        Command="{Binding NavigateForwardCommand}"
                                        Margin="0,0,10,0" Width="80"/>

                        <!-- History Info -->
                        <TextBlock Grid.Column="2"
                                  VerticalAlignment="Center"
                                  Foreground="#FF999999"
                                  Margin="10,0,0,0"
                                  Text="{Binding HistoryStatusText, FallbackValue='History: 0 / 0'}"/>

                        <!-- Apply Button -->
                        <dx:SimpleButton Grid.Column="3" Content="Apply"
                                        Command="{Binding ApplyCurrentChangesCommand}"
                                        Margin="10,0,5,0" Width="100"
                                        Background="#FF28A745"
                                        Foreground="White"
                                        FontWeight="Bold"/>

                        <!-- Clear Button -->
                        <dx:SimpleButton Grid.Column="4" Content="Clear"
                                        Command="{Binding ClearPreviewCommand}"
                                        Margin="0,0,10,0" Width="100"
                                        Background="#FFDC3545"
                                        Foreground="White"
                                        FontWeight="Bold"/>

                        <!-- History Count Badge -->
                        <Border Grid.Column="5"
                               Background="#FF007ACC"
                               CornerRadius="10"
                               Padding="8,4"
                               VerticalAlignment="Center">
                            <TextBlock Foreground="White" FontWeight="Bold" FontSize="11">
                                <Run Text="{Binding HistoryCount, Mode=OneWay, FallbackValue=0}"/>
                                <Run Text=" / 5"/>
                            </TextBlock>
                        </Border>
                    </Grid>
                </Border>

                <Grid Grid.Row="1">
                    <Grid.ColumnDefinitions>
                        <ColumnDefinition Width="*"/>
                        <ColumnDefinition Width="5"/>
                        <ColumnDefinition Width="*"/>
                    </Grid.ColumnDefinitions>

                <!-- Original Image Viewer -->
                <Border Grid.Column="0" Background="#FF2D2D30" Margin="5">
                    <Grid>
                        <Image x:Name="OriginalImage"
                               Source="{Binding OriginalImage}"
                               Stretch="{Binding ImageStretch}"
                               HorizontalAlignment="Center"
                               VerticalAlignment="Center"
                               RenderOptions.BitmapScalingMode="HighQuality"/>

                        <!-- Original Label -->
                        <Border HorizontalAlignment="Left"
                                VerticalAlignment="Top"
                                Margin="10"
                                Background="#DD000000"
                                BorderBrush="#FF555555"
                                BorderThickness="1"
                                CornerRadius="4"
                                Padding="8,4">
                            <TextBlock Text="Original"
                                      Foreground="White"
                                      FontSize="12"
                                      FontWeight="Bold"/>
                        </Border>
                    </Grid>
                </Border>

                <!-- Splitter -->
                <GridSplitter Grid.Column="1"
                             Width="5"
                             HorizontalAlignment="Stretch"
                             Background="#FF3E3E42"/>

                <!-- Processed Image Viewer -->
                <Border Grid.Column="2" Background="#FF2D2D30" Margin="5">
                    <Grid>
                        <Image x:Name="MainImage"
                               Source="{Binding ProcessedImage}"
                               Stretch="{Binding ImageStretch}"
                               HorizontalAlignment="Center"
                               VerticalAlignment="Center"
                               RenderOptions.BitmapScalingMode="HighQuality"
                               MouseMove="MainImage_MouseMove"
                               MouseLeave="MainImage_MouseLeave"/>
                        <ScrollViewer x:Name="ImageScrollViewer"
                                     HorizontalScrollBarVisibility="Auto"
                                     VerticalScrollBarVisibility="Auto"
                                     Visibility="Collapsed">
                            <Image x:Name="ScrollImage"
                                   Source="{Binding ProcessedImage}"
                                   Stretch="None"
                                   RenderOptions.BitmapScalingMode="HighQuality"
                                   MouseMove="ScrollImage_MouseMove"
                                   MouseLeave="ScrollImage_MouseLeave"/>
                        </ScrollViewer>

                        <!-- Processed Label -->
                        <Border HorizontalAlignment="Left"
                                VerticalAlignment="Top"
                                Margin="10"
                                Background="#DD000000"
                                BorderBrush="#FF555555"
                                BorderThickness="1"
                                CornerRadius="4"
                                Padding="8,4">
                            <TextBlock Text="Processed"
                                      Foreground="#FF4ECDC4"
                                      FontSize="12"
                                      FontWeight="Bold"/>
                        </Border>

                        <!-- Pixel Info Overlay -->
                        <Border x:Name="PixelInfoPanel"
                                HorizontalAlignment="Right"
                                VerticalAlignment="Top"
                                Margin="10"
                                Background="#DD000000"
                                BorderBrush="#FF555555"
                                BorderThickness="1"
                                CornerRadius="4"
                                Padding="10,5"
                                Visibility="Collapsed">
                            <StackPanel>
                                <TextBlock x:Name="PixelPositionText"
                                          Text="X: 0, Y: 0"
                                          Foreground="White"
                                          FontSize="11"
                                          FontFamily="Consolas"/>
                                <TextBlock x:Name="PixelRgbText"
                                          Text="RGB: (0, 0, 0)"
                                          Foreground="#FFFF6B6B"
                                          FontSize="11"
                                          FontFamily="Consolas"
                                          Margin="0,2,0,0"/>
                                <TextBlock x:Name="PixelHsvText"
                                          Text="HSV: (0°, 0%, 0%)"
                                          Foreground="#FF4ECDC4"
                                          FontSize="11"
                                          FontFamily="Consolas"
                                          Margin="0,2,0,0"/>
                            </StackPanel>
                        </Border>
                    </Grid>
                </Border>
                </Grid>

                <!-- Effect Control Panel (Row 2) -->
                <Border Grid.Row="2" Background="#FF252526" BorderBrush="#FF3E3E42" BorderThickness="0,1,0,0" Padding="10">
                    <StackPanel>
                        <!-- Red Eye Reduction Controls -->
                        <dxlc:GroupBox Header="Red Eye Reduction" Margin="0,5">
                            <dxlc:GroupBox.Visibility>
                                <Binding Path="CurrentEffectType">
                                    <Binding.Converter>
                                        <local:EffectTypeToVisibilityConverter TargetEffect="RedEyeReduction"/>
                                    </Binding.Converter>
                                </Binding>
                            </dxlc:GroupBox.Visibility>
                            <StackPanel>
                                <TextBlock Text="Detection Threshold" Margin="0,5,0,2" Foreground="White"/>
                                <Grid>
                                    <Grid.ColumnDefinitions>
                                        <ColumnDefinition Width="*"/>
                                        <ColumnDefinition Width="50"/>
                                    </Grid.ColumnDefinitions>
                                    <Slider Grid.Column="0" Minimum="100" Maximum="255"
                                            Value="{Binding RedEyeThreshold, Mode=TwoWay}"
                                            TickFrequency="5" IsSnapToTickEnabled="True"/>
                                    <TextBlock Grid.Column="1" Text="{Binding RedEyeThreshold}"
                                               VerticalAlignment="Center" HorizontalAlignment="Center" Foreground="White"/>
                                </Grid>

                                <TextBlock Text="Red Reduction Level" Margin="0,10,0,2" Foreground="#FFFF6B6B"/>
                                <Grid>
                                    <Grid.ColumnDefinitions>
                                        <ColumnDefinition Width="*"/>
                                        <ColumnDefinition Width="50"/>
                                    </Grid.ColumnDefinitions>
                                    <Slider Grid.Column="0" Minimum="0" Maximum="100"
                                            Value="{Binding RedEyeLevel, Mode=TwoWay}"
                                            TickFrequency="1" IsSnapToTickEnabled="True"/>
                                    <TextBlock Grid.Column="1" Text="{Binding RedEyeLevel}"
                                               VerticalAlignment="Center" HorizontalAlignment="Center" Foreground="White"/>
                                </Grid>
                            </StackPanel>
                        </dxlc:GroupBox>

                        <!-- Green Eye Reduction Controls -->
                        <dxlc:GroupBox Header="Green Eye Reduction" Margin="0,5">
                            <dxlc:GroupBox.Visibility>
                                <Binding Path="CurrentEffectType">
                                    <Binding.Converter>
                                        <local:EffectTypeToVisibilityConverter TargetEffect="GreenEyeReduction"/>
                                    </Binding.Converter>
                                </Binding>
                            </dxlc:GroupBox.Visibility>
                            <StackPanel>
                                <TextBlock Text="Detection Threshold" Margin="0,5,0,2" Foreground="White"/>
                                <Grid>
                                    <Grid.ColumnDefinitions>
                                        <ColumnDefinition Width="*"/>
                                        <ColumnDefinition Width="50"/>
                                    </Grid.ColumnDefinitions>
                                    <Slider Grid.Column="0" Minimum="100" Maximum="255"
                                            Value="{Binding GreenEyeThreshold, Mode=TwoWay}"
                                            TickFrequency="5" IsSnapToTickEnabled="True"/>
                                    <TextBlock Grid.Column="1" Text="{Binding GreenEyeThreshold}"
                                               VerticalAlignment="Center" HorizontalAlignment="Center" Foreground="White"/>
                                </Grid>

                                <TextBlock Text="Green Reduction Level" Margin="0,10,0,2" Foreground="#FF6BFF6B"/>
                                <Grid>
                                    <Grid.ColumnDefinitions>
                                        <ColumnDefinition Width="*"/>
                                        <ColumnDefinition Width="50"/>
                                    </Grid.ColumnDefinitions>
                                    <Slider Grid.Column="0" Minimum="0" Maximum="100"
                                            Value="{Binding GreenEyeLevel, Mode=TwoWay}"
                                            TickFrequency="1" IsSnapToTickEnabled="True"/>
                                    <TextBlock Grid.Column="1" Text="{Binding GreenEyeLevel}"
                                               VerticalAlignment="Center" HorizontalAlignment="Center" Foreground="White"/>
                                </Grid>
                            </StackPanel>
                        </dxlc:GroupBox>

                        <!-- Blue Eye Reduction Controls -->
                        <dxlc:GroupBox Header="Blue Eye Reduction" Margin="0,5">
                            <dxlc:GroupBox.Visibility>
                                <Binding Path="CurrentEffectType">
                                    <Binding.Converter>
                                        <local:EffectTypeToVisibilityConverter TargetEffect="BlueEyeReduction"/>
                                    </Binding.Converter>
                                </Binding>
                            </dxlc:GroupBox.Visibility>
                            <StackPanel>
                                <TextBlock Text="Detection Threshold" Margin="0,5,0,2" Foreground="White"/>
                                <Grid>
                                    <Grid.ColumnDefinitions>
                                        <ColumnDefinition Width="*"/>
                                        <ColumnDefinition Width="50"/>
                                    </Grid.ColumnDefinitions>
                                    <Slider Grid.Column="0" Minimum="100" Maximum="255"
                                            Value="{Binding BlueEyeThreshold, Mode=TwoWay}"
                                            TickFrequency="5" IsSnapToTickEnabled="True"/>
                                    <TextBlock Grid.Column="1" Text="{Binding BlueEyeThreshold}"
                                               VerticalAlignment="Center" HorizontalAlignment="Center" Foreground="White"/>
                                </Grid>

                                <TextBlock Text="Blue Reduction Level" Margin="0,10,0,2" Foreground="#FF6B6BFF"/>
                                <Grid>
                                    <Grid.ColumnDefinitions>
                                        <ColumnDefinition Width="*"/>
                                        <ColumnDefinition Width="50"/>
                                    </Grid.ColumnDefinitions>
                                    <Slider Grid.Column="0" Minimum="0" Maximum="100"
                                            Value="{Binding BlueEyeLevel, Mode=TwoWay}"
                                            TickFrequency="1" IsSnapToTickEnabled="True"/>
                                    <TextBlock Grid.Column="1" Text="{Binding BlueEyeLevel}"
                                               VerticalAlignment="Center" HorizontalAlignment="Center" Foreground="White"/>
                                </Grid>
                            </StackPanel>
                        </dxlc:GroupBox>

                        <!-- Blur Controls -->
                        <dxlc:GroupBox Header="Blur" Margin="0,5">
                            <dxlc:GroupBox.Visibility>
                                <Binding Path="CurrentEffectType">
                                    <Binding.Converter>
                                        <local:EffectTypeToVisibilityConverter TargetEffect="Blur"/>
                                    </Binding.Converter>
                                </Binding>
                            </dxlc:GroupBox.Visibility>
                            <StackPanel>
                                <TextBlock Text="Blur Sigma" Margin="0,5,0,2" Foreground="White"/>
                                <Grid>
                                    <Grid.ColumnDefinitions>
                                        <ColumnDefinition Width="*"/>
                                        <ColumnDefinition Width="50"/>
                                    </Grid.ColumnDefinitions>
                                    <Slider Grid.Column="0" Minimum="0.1" Maximum="50"
                                            Value="{Binding BlurSigma, Mode=TwoWay}"
                                            TickFrequency="0.5" IsSnapToTickEnabled="True"/>
                                    <TextBlock Grid.Column="1" Text="{Binding BlurSigma, StringFormat='{}{0:F1}'}"
                                               VerticalAlignment="Center" HorizontalAlignment="Center" Foreground="White"/>
                                </Grid>
                            </StackPanel>
                        </dxlc:GroupBox>

                        <!-- Sharpen Controls -->
                        <dxlc:GroupBox Header="Sharpen" Margin="0,5">
                            <dxlc:GroupBox.Visibility>
                                <Binding Path="CurrentEffectType">
                                    <Binding.Converter>
                                        <local:EffectTypeToVisibilityConverter TargetEffect="Sharpen"/>
                                    </Binding.Converter>
                                </Binding>
                            </dxlc:GroupBox.Visibility>
                            <StackPanel>
                                <TextBlock Text="Sharpen Amount" Margin="0,5,0,2" Foreground="White"/>
                                <Grid>
                                    <Grid.ColumnDefinitions>
                                        <ColumnDefinition Width="*"/>
                                        <ColumnDefinition Width="50"/>
                                    </Grid.ColumnDefinitions>
                                    <Slider Grid.Column="0" Minimum="0" Maximum="5"
                                            Value="{Binding SharpenAmount, Mode=TwoWay}"
                                            TickFrequency="0.1" IsSnapToTickEnabled="True"/>
                                    <TextBlock Grid.Column="1" Text="{Binding SharpenAmount, StringFormat='{}{0:F1}'}"
                                               VerticalAlignment="Center" HorizontalAlignment="Center" Foreground="White"/>
                                </Grid>
                            </StackPanel>
                        </dxlc:GroupBox>

                        <!-- Median Filter Controls -->
                        <dxlc:GroupBox Header="Median Filter" Margin="0,5">
                            <dxlc:GroupBox.Visibility>
                                <Binding Path="CurrentEffectType">
                                    <Binding.Converter>
                                        <local:EffectTypeToVisibilityConverter TargetEffect="MedianFilter"/>
                                    </Binding.Converter>
                                </Binding>
                            </dxlc:GroupBox.Visibility>
                            <StackPanel>
                                <TextBlock Text="Radius" Margin="0,5,0,2" Foreground="White"/>
                                <Grid>
                                    <Grid.ColumnDefinitions>
                                        <ColumnDefinition Width="*"/>
                                        <ColumnDefinition Width="50"/>
                                    </Grid.ColumnDefinitions>
                                    <Slider Grid.Column="0" Minimum="1" Maximum="10"
                                            Value="{Binding MedianFilterRadius, Mode=TwoWay}"
                                            TickFrequency="1" IsSnapToTickEnabled="True"/>
                                    <TextBlock Grid.Column="1" Text="{Binding MedianFilterRadius}"
                                               VerticalAlignment="Center" HorizontalAlignment="Center" Foreground="White"/>
                                </Grid>
                            </StackPanel>
                        </dxlc:GroupBox>

                        <!-- Box Blur Controls -->
                        <dxlc:GroupBox Header="Box Blur" Margin="0,5">
                            <dxlc:GroupBox.Visibility>
                                <Binding Path="CurrentEffectType">
                                    <Binding.Converter>
                                        <local:EffectTypeToVisibilityConverter TargetEffect="BoxBlur"/>
                                    </Binding.Converter>
                                </Binding>
                            </dxlc:GroupBox.Visibility>
                            <StackPanel>
                                <TextBlock Text="Radius" Margin="0,5,0,2" Foreground="White"/>
                                <Grid>
                                    <Grid.ColumnDefinitions>
                                        <ColumnDefinition Width="*"/>
                                        <ColumnDefinition Width="50"/>
                                    </Grid.ColumnDefinitions>
                                    <Slider Grid.Column="0" Minimum="1" Maximum="20"
                                            Value="{Binding BoxBlurRadius, Mode=TwoWay}"
                                            TickFrequency="1" IsSnapToTickEnabled="True"/>
                                    <TextBlock Grid.Column="1" Text="{Binding BoxBlurRadius}"
                                               VerticalAlignment="Center" HorizontalAlignment="Center" Foreground="White"/>
                                </Grid>
                            </StackPanel>
                        </dxlc:GroupBox>

                        <!-- Remove Red Channel Controls -->
                        <dxlc:GroupBox Header="Remove Red Channel" Margin="0,5">
                            <dxlc:GroupBox.Visibility>
                                <Binding Path="CurrentEffectType">
                                    <Binding.Converter>
                                        <local:EffectTypeToVisibilityConverter TargetEffect="RemoveRedChannel"/>
                                    </Binding.Converter>
                                </Binding>
                            </dxlc:GroupBox.Visibility>
                            <StackPanel>
                                <TextBlock Text="Remove Red Level" Margin="0,5,0,2" Foreground="#FFFF6B6B"/>
                                <Grid>
                                    <Grid.ColumnDefinitions>
                                        <ColumnDefinition Width="*"/>
                                        <ColumnDefinition Width="50"/>
                                    </Grid.ColumnDefinitions>
                                    <Slider Grid.Column="0" Minimum="0" Maximum="100"
                                            Value="{Binding RemoveRedLevel, Mode=TwoWay}"
                                            TickFrequency="1" IsSnapToTickEnabled="True"/>
                                    <TextBlock Grid.Column="1" Text="{Binding RemoveRedLevel}"
                                               VerticalAlignment="Center" HorizontalAlignment="Center" Foreground="White"/>
                                </Grid>
                            </StackPanel>
                        </dxlc:GroupBox>

                        <!-- Remove Green Channel Controls -->
                        <dxlc:GroupBox Header="Remove Green Channel" Margin="0,5">
                            <dxlc:GroupBox.Visibility>
                                <Binding Path="CurrentEffectType">
                                    <Binding.Converter>
                                        <local:EffectTypeToVisibilityConverter TargetEffect="RemoveGreenChannel"/>
                                    </Binding.Converter>
                                </Binding>
                            </dxlc:GroupBox.Visibility>
                            <StackPanel>
                                <TextBlock Text="Remove Green Level" Margin="0,5,0,2" Foreground="#FF6BFF6B"/>
                                <Grid>
                                    <Grid.ColumnDefinitions>
                                        <ColumnDefinition Width="*"/>
                                        <ColumnDefinition Width="50"/>
                                    </Grid.ColumnDefinitions>
                                    <Slider Grid.Column="0" Minimum="0" Maximum="100"
                                            Value="{Binding RemoveGreenLevel, Mode=TwoWay}"
                                            TickFrequency="1" IsSnapToTickEnabled="True"/>
                                    <TextBlock Grid.Column="1" Text="{Binding RemoveGreenLevel}"
                                               VerticalAlignment="Center" HorizontalAlignment="Center" Foreground="White"/>
                                </Grid>
                            </StackPanel>
                        </dxlc:GroupBox>

                        <!-- Remove Blue Channel Controls -->
                        <dxlc:GroupBox Header="Remove Blue Channel" Margin="0,5">
                            <dxlc:GroupBox.Visibility>
                                <Binding Path="CurrentEffectType">
                                    <Binding.Converter>
                                        <local:EffectTypeToVisibilityConverter TargetEffect="RemoveBlueChannel"/>
                                    </Binding.Converter>
                                </Binding>
                            </dxlc:GroupBox.Visibility>
                            <StackPanel>
                                <TextBlock Text="Remove Blue Level" Margin="0,5,0,2" Foreground="#FF6B6BFF"/>
                                <Grid>
                                    <Grid.ColumnDefinitions>
                                        <ColumnDefinition Width="*"/>
                                        <ColumnDefinition Width="50"/>
                                    </Grid.ColumnDefinitions>
                                    <Slider Grid.Column="0" Minimum="0" Maximum="100"
                                            Value="{Binding RemoveBlueLevel, Mode=TwoWay}"
                                            TickFrequency="1" IsSnapToTickEnabled="True"/>
                                    <TextBlock Grid.Column="1" Text="{Binding RemoveBlueLevel}"
                                               VerticalAlignment="Center" HorizontalAlignment="Center" Foreground="White"/>
                                </Grid>
                            </StackPanel>
                        </dxlc:GroupBox>
                    </StackPanel>
                </Border>
            </Grid>

            <!-- Control Panel -->
            <Border Grid.Column="1" BorderThickness="1,0,0,0">
                <ScrollViewer VerticalScrollBarVisibility="Auto">
                    <StackPanel Margin="10">

                        <!-- Basic Adjustments -->
                        <dxlc:GroupBox Header="Basic Adjustments" Margin="0,5">
                            <StackPanel>
                                <TextBlock Text="Brightness" Margin="0,5,0,2"/>
                                <Grid>
                                    <Grid.ColumnDefinitions>
                                        <ColumnDefinition Width="*"/>
                                        <ColumnDefinition Width="50"/>
                                    </Grid.ColumnDefinitions>
                                    <Slider Grid.Column="0" Minimum="-100" Maximum="100"
                                            Value="{Binding Brightness, Mode=TwoWay}"
                                            TickFrequency="10" IsSnapToTickEnabled="True"/>
                                    <TextBlock Grid.Column="1" Text="{Binding Brightness, StringFormat='{}{0:F0}'}"
                                               VerticalAlignment="Center" HorizontalAlignment="Center"/>
                                </Grid>

                                <TextBlock Text="Contrast" Margin="0,10,0,2"/>
                                <Grid>
                                    <Grid.ColumnDefinitions>
                                        <ColumnDefinition Width="*"/>
                                        <ColumnDefinition Width="50"/>
                                    </Grid.ColumnDefinitions>
                                    <Slider Grid.Column="0" Minimum="-100" Maximum="100"
                                            Value="{Binding Contrast, Mode=TwoWay}"
                                            TickFrequency="10" IsSnapToTickEnabled="True"/>
                                    <TextBlock Grid.Column="1" Text="{Binding Contrast, StringFormat='{}{0:F0}'}"
                                               VerticalAlignment="Center" HorizontalAlignment="Center"/>
                                </Grid>

                                <TextBlock Text="Gamma" Margin="0,10,0,2"/>
                                <Grid>
                                    <Grid.ColumnDefinitions>
                                        <ColumnDefinition Width="*"/>
                                        <ColumnDefinition Width="50"/>
                                    </Grid.ColumnDefinitions>
                                    <Slider Grid.Column="0" Minimum="0.1" Maximum="3.0"
                                            Value="{Binding Gamma, Mode=TwoWay}"
                                            TickFrequency="0.1" IsSnapToTickEnabled="True"/>
                                    <TextBlock Grid.Column="1" Text="{Binding Gamma, StringFormat='{}{0:F1}'}"
                                               VerticalAlignment="Center" HorizontalAlignment="Center"/>
                                </Grid>
                            </StackPanel>
                        </dxlc:GroupBox>

                        <!-- Color Adjustments -->
                        <dxlc:GroupBox Header="Color Adjustments" Margin="0,5">
                            <StackPanel>
                                <TextBlock Text="Saturation" Margin="0,5,0,2"/>
                                <Grid>
                                    <Grid.ColumnDefinitions>
                                        <ColumnDefinition Width="*"/>
                                        <ColumnDefinition Width="50"/>
                                    </Grid.ColumnDefinitions>
                                    <Slider Grid.Column="0" Minimum="-100" Maximum="100"
                                            Value="{Binding Saturation, Mode=TwoWay}"
                                            TickFrequency="10" IsSnapToTickEnabled="True"/>
                                    <TextBlock Grid.Column="1" Text="{Binding Saturation, StringFormat='{}{0:F0}'}"
                                               VerticalAlignment="Center" HorizontalAlignment="Center"/>
                                </Grid>

                                <TextBlock Text="Hue" Margin="0,10,0,2"/>
                                <Grid>
                                    <Grid.ColumnDefinitions>
                                        <ColumnDefinition Width="*"/>
                                        <ColumnDefinition Width="50"/>
                                    </Grid.ColumnDefinitions>
                                    <Slider Grid.Column="0" Minimum="-180" Maximum="180"
                                            Value="{Binding Hue, Mode=TwoWay}"
                                            TickFrequency="15" IsSnapToTickEnabled="True"/>
                                    <TextBlock Grid.Column="1" Text="{Binding Hue, StringFormat='{}{0:F0}'}"
                                               VerticalAlignment="Center" HorizontalAlignment="Center"/>
                                </Grid>

                                <TextBlock Text="Red Channel" Margin="0,10,0,2"/>
                                <Grid>
                                    <Grid.ColumnDefinitions>
                                        <ColumnDefinition Width="*"/>
                                        <ColumnDefinition Width="50"/>
                                    </Grid.ColumnDefinitions>
                                    <Slider Grid.Column="0" Minimum="-100" Maximum="100"
                                            Value="{Binding RedAdjustment, Mode=TwoWay}"
                                            TickFrequency="10" IsSnapToTickEnabled="True"/>
                                    <TextBlock Grid.Column="1" Text="{Binding RedAdjustment, StringFormat='{}{0:F0}'}"
                                               VerticalAlignment="Center" HorizontalAlignment="Center" Foreground="Red"/>
                                </Grid>

                                <TextBlock Text="Green Channel" Margin="0,10,0,2"/>
                                <Grid>
                                    <Grid.ColumnDefinitions>
                                        <ColumnDefinition Width="*"/>
                                        <ColumnDefinition Width="50"/>
                                    </Grid.ColumnDefinitions>
                                    <Slider Grid.Column="0" Minimum="-100" Maximum="100"
                                            Value="{Binding GreenAdjustment, Mode=TwoWay}"
                                            TickFrequency="10" IsSnapToTickEnabled="True"/>
                                    <TextBlock Grid.Column="1" Text="{Binding GreenAdjustment, StringFormat='{}{0:F0}'}"
                                               VerticalAlignment="Center" HorizontalAlignment="Center" Foreground="Green"/>
                                </Grid>

                                <TextBlock Text="Blue Channel" Margin="0,10,0,2"/>
                                <Grid>
                                    <Grid.ColumnDefinitions>
                                        <ColumnDefinition Width="*"/>
                                        <ColumnDefinition Width="50"/>
                                    </Grid.ColumnDefinitions>
                                    <Slider Grid.Column="0" Minimum="-100" Maximum="100"
                                            Value="{Binding BlueAdjustment, Mode=TwoWay}"
                                            TickFrequency="10" IsSnapToTickEnabled="True"/>
                                    <TextBlock Grid.Column="1" Text="{Binding BlueAdjustment, StringFormat='{}{0:F0}'}"
                                               VerticalAlignment="Center" HorizontalAlignment="Center" Foreground="Blue"/>
                                </Grid>
                            </StackPanel>
                        </dxlc:GroupBox>

                        <!-- Filter Parameters -->
                        <dxlc:GroupBox Header="Filter Parameters" Margin="0,5">
                            <StackPanel>
                                <TextBlock Text="Blur Sigma" Margin="0,5,0,2"/>
                                <Grid>
                                    <Grid.ColumnDefinitions>
                                        <ColumnDefinition Width="*"/>
                                        <ColumnDefinition Width="50"/>
                                    </Grid.ColumnDefinitions>
                                    <Slider Grid.Column="0" Minimum="0.1" Maximum="50"
                                            Value="{Binding BlurSigma, Mode=TwoWay}"
                                            TickFrequency="0.5" IsSnapToTickEnabled="True"/>
                                    <TextBlock Grid.Column="1" Text="{Binding BlurSigma, StringFormat='{}{0:F1}'}"
                                               VerticalAlignment="Center" HorizontalAlignment="Center"/>
                                </Grid>

                                <TextBlock Text="Sharpen Amount" Margin="0,10,0,2"/>
                                <Grid>
                                    <Grid.ColumnDefinitions>
                                        <ColumnDefinition Width="*"/>
                                        <ColumnDefinition Width="50"/>
                                    </Grid.ColumnDefinitions>
                                    <Slider Grid.Column="0" Minimum="0" Maximum="5"
                                            Value="{Binding SharpenAmount, Mode=TwoWay}"
                                            TickFrequency="0.1" IsSnapToTickEnabled="True"/>
                                    <TextBlock Grid.Column="1" Text="{Binding SharpenAmount, StringFormat='{}{0:F1}'}"
                                               VerticalAlignment="Center" HorizontalAlignment="Center"/>
                                </Grid>
                            </StackPanel>
                        </dxlc:GroupBox>

                    </StackPanel>
                </ScrollViewer>
            </Border>
        </Grid>

        <!-- Status Bar -->
        <dxb:StatusBarControl Grid.Row="2">
            <dxb:BarStaticItem Content="{Binding StatusText}"/>
        </dxb:StatusBarControl>

    </Grid>
</dx:ThemedWindow>
